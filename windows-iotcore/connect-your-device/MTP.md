---
title: Media Transfer-Protokoll
author: PawelWMS
ms.author: pawelwi
ms.date: 12/06/2017
ms.topic: article
description: Erfahren Sie, wie Sie die optionale Funktion von Medien-Transfer-Protokolls (MTP) zum Übertragen von Dateien in und aus Ihrer Geräte über USB zu aktivieren.
keywords: Windows Iot, MTP, Media transfer-Protokoll, die Übertragung von Dateien, die Geräte
ms.openlocfilehash: 72856617c8d49a1b06eadd13ab5fb085340d2ed4
ms.sourcegitcommit: ef85ccba54b1118d49554e88768240020ff514b0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/11/2019
ms.locfileid: "59512322"
---
# <a name="media-transfer-protocol"></a><span data-ttu-id="72729-104">Media Transfer-Protokoll</span><span class="sxs-lookup"><span data-stu-id="72729-104">Media Transfer Protocol</span></span>
<span data-ttu-id="72729-105">Des Media Transfer-Protokolls (MTP) ermöglicht Ihnen, zum Übertragen von Dateien in und aus Ihr Windows 10 IoT Core-Gerät per USB.</span><span class="sxs-lookup"><span data-stu-id="72729-105">The Media Transfer Protocol (MTP) allows you to transfer files to and from your Windows 10 IoT Core device through USB.</span></span> <span data-ttu-id="72729-106">Sie können den Zugriff auf internen Speicher des Geräts und der SD-Karte, falls vorhanden.</span><span class="sxs-lookup"><span data-stu-id="72729-106">It allows access to the device's internal storage and the SD card, if present.</span></span>

<span data-ttu-id="72729-107">Das Feature ist Teil der IoT-Core-Kits, die heruntergeladen und installiert werden kann die [Windows 10 IoT Core Pakete](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span><span class="sxs-lookup"><span data-stu-id="72729-107">The feature is part of the IoT Core Kits, which can be downloaded and installed from the [Windows 10 IoT Core Packages](https://www.microsoft.com/en-us/download/details.aspx?id=55031).</span></span>

## <a name="how-to-install-the-mtp-feature-on-a-device-running-windows-10-iot-core"></a><span data-ttu-id="72729-108">Gewusst wie: Installieren des MTP-Features auf einem Gerät mit Windows 10 IoT Core</span><span class="sxs-lookup"><span data-stu-id="72729-108">How to install the MTP feature on a device running Windows 10 IoT Core</span></span>

### <a name="provisioning-the-device-with-required-packages"></a><span data-ttu-id="72729-109">Bereitstellen des Geräts mit der erforderlichen Pakete</span><span class="sxs-lookup"><span data-stu-id="72729-109">Provisioning the device with required packages</span></span>

1. <span data-ttu-id="72729-110">Starten Sie [Powershell](../connect-your-device/PowerShell.md) oder [SSH](../connect-your-device/SSH.md) und greifen Sie auf Ihrem Gerät Windows 10 IoT Core ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="72729-110">Launch [Powershell](../connect-your-device/PowerShell.md) or [SSH](../connect-your-device/SSH.md) and access your device running Windows 10 IoT Core.</span></span>
2. <span data-ttu-id="72729-111">Führen Sie über Powershell oder SSH folgende Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="72729-111">From Powershell or SSH, do the following:</span></span>
    1. <span data-ttu-id="72729-112">Erstellen Sie einen temporären Ordner auf dem Zielcomputer (z. B. `C:\MTPTemp`).</span><span class="sxs-lookup"><span data-stu-id="72729-112">Create a temporary folder on the target machine (e.g. `C:\MTPTemp`).</span></span>
    2. <span data-ttu-id="72729-113">Kopieren Sie die folgenden Pakete basierend auf Ihrem Gerät die Architektur von Ihrem PC (`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`) zu `C:\MTPTemp`:</span><span class="sxs-lookup"><span data-stu-id="72729-113">Based on your device's architecture, copy the following packages from your PC (`C:\Program Files (x86)\Windows Kits\10\MSPackages\Retail\<arch>\fre`) to `C:\MTPTemp`:</span></span>
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
    3. <span data-ttu-id="72729-114">Führen Sie folgende Befehle aus `C:\MTPTemp` zum Installieren der Pakete auf Ihrem IoT-Gerät-Systemabbild:</span><span class="sxs-lookup"><span data-stu-id="72729-114">Run these commands from `C:\MTPTemp` to install the packages to your IoT device's system image:</span></span>
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-OneCoreUAP-Mtp-UserService-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package.cab`
        * `ApplyUpdate.exe -stage Microsoft-WindowsStorSvc-API-Schema-Extension-Package_Lang_en-US.cab`
        * `ApplyUpdate.exe -commit`
3. <span data-ttu-id="72729-115">Das Gerät wird gestartet wird, um die Betriebssystemversion aktualisieren, die MTP-Funktion installieren und neu starten, um die MainOS.</span><span class="sxs-lookup"><span data-stu-id="72729-115">The device will boot to the Update OS, install the MTP feature, and reboot to the MainOS.</span></span>

### <a name="enabling-the-mtp-usb-interface"></a><span data-ttu-id="72729-116">Aktivieren die MTP USB-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="72729-116">Enabling the MTP USB interface</span></span>

<span data-ttu-id="72729-117">Sobald das Gerät wieder auf die MainOS verfügbar ist, muss die USBFN Konfiguration immer noch aktualisiert werden, um das Einschließen von MTP.</span><span class="sxs-lookup"><span data-stu-id="72729-117">Once the device comes back to the MainOS, the USBFN configuration still needs to be updated to include MTP.</span></span> <span data-ttu-id="72729-118">Zu diesem Zweck müssen Sie die Schnittstellen aufgelistet USBFN MTP hinzu.</span><span class="sxs-lookup"><span data-stu-id="72729-118">In order to do that, you will need to add MTP to the interfaces enumerated by USBFN.</span></span>
<span data-ttu-id="72729-119">Die [USB-registrierungseinstellungen](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) Artikel wird erläutert, die Details des USB-Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="72729-119">The [USB registry settings](https://docs.microsoft.com/windows-hardware/drivers/usbcon/usb-registry-settings-for-a-function-controller-driver) article explains the details of USB's configuration.</span></span>

<span data-ttu-id="72729-120">Während Sie die USBFN-Standardkonfiguration, die unter ändern, können die `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` Schlüssel, es wird empfohlen, Ihre eigenen definieren, wie sie von Systemupdates nicht überschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="72729-120">While you can modify the default USBFN configuration available under the `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default` key, it is recommended to define your own, as they will not get overwritten by system updates.</span></span>

#### <a name="creating-a-new-usbfn-configuration-with-the-mtp-interface"></a><span data-ttu-id="72729-121">Erstellen eine neue USBFN-Konfiguration mit der MTP-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="72729-121">Creating a new USBFN configuration with the MTP interface</span></span>

<span data-ttu-id="72729-122">Um eine neue Konfiguration für MTP hinzuzufügen, gehen Sie wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="72729-122">Follow these steps to add a new configuration with MTP:</span></span>
1. <span data-ttu-id="72729-123">Hinzufügen eines neuen Schlüssels unter `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span><span class="sxs-lookup"><span data-stu-id="72729-123">Add a new key under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations`.</span></span> <span data-ttu-id="72729-124">Beispiel: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="72729-124">Example: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\MyConfiguration`.</span></span>
2. <span data-ttu-id="72729-125">Erstellen Sie unter den neuen Schlüssel ein `REG_MULTI_SZ` Wert `InterfaceList` gleich `MTP`.</span><span class="sxs-lookup"><span data-stu-id="72729-125">Under the new key create a `REG_MULTI_SZ` value `InterfaceList` equal to `MTP`.</span></span>
3. <span data-ttu-id="72729-126">Erstellen Sie unter dem gleichen Schlüssel eine `REG_BINARY` Wert `MSOSCompatIdDescriptor` gleich `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`.</span><span class="sxs-lookup"><span data-stu-id="72729-126">Under the same key create a `REG_BINARY` value `MSOSCompatIdDescriptor` equal to `2800000000010400010000000000000000014D545000000000000000000000000000000000000000`.</span></span>
4. <span data-ttu-id="72729-127">Klicken Sie unter `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` fügen Sie einen neuen `REG_SZ` Wert `CurrentConfiguration` gleich dem Namen des neu erstellten Schlüssels.</span><span class="sxs-lookup"><span data-stu-id="72729-127">Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_SZ` value `CurrentConfiguration` equal to the name of the newly created key.</span></span> <span data-ttu-id="72729-128">In diesem Fall wäre es `MyConfiguration`.</span><span class="sxs-lookup"><span data-stu-id="72729-128">In this case it would be `MyConfiguration`.</span></span>
5. <span data-ttu-id="72729-129">[**Optional**] unter `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` fügen Sie einen neuen `REG_DWORD` Wert `IncludeDefaultCfg` gleich 1.</span><span class="sxs-lookup"><span data-stu-id="72729-129">[**Optional**] Under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN` add a new `REG_DWORD` value `IncludeDefaultCfg` equal to 1.</span></span> <span data-ttu-id="72729-130">Dies veranlasst, dass den USB-Treiber die Standard-Schnittstellen zusammen mit MTP aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="72729-130">This will make the USB driver enumerate the default interfaces along with MTP.</span></span>

> [!NOTE]
> <span data-ttu-id="72729-131">Wenn Sie bereits eine benutzerdefinierte Konfiguration verwenden, müssen Sie es ändern, anstatt einen neuen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="72729-131">If you are already using a custom configuration you will have to modify it instead of creating a new one.</span></span>

#### <a name="adding-the-mtp-interface-to-an-existing-configuration"></a><span data-ttu-id="72729-132">Hinzufügen der MTP-Schnittstelle zu einer vorhandenen Konfiguration</span><span class="sxs-lookup"><span data-stu-id="72729-132">Adding the MTP interface to an existing configuration</span></span>

<span data-ttu-id="72729-133">Um eine vorhandene Konfiguration einer USBFN MTP hinzuzufügen, gehen Sie wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="72729-133">Follow these steps to add MTP to an existing USBFN configuration:</span></span>
1. <span data-ttu-id="72729-134">Suchen Sie die aktuelle Konfiguration anhand der `CurrentConfiguration` Wert `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span><span class="sxs-lookup"><span data-stu-id="72729-134">Find the current configuration by checking the `CurrentConfiguration` value under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN`.</span></span> <span data-ttu-id="72729-135">Wenn der Wert vorhanden ist, wird die aktuelle Konfiguration Sie unter finden `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span><span class="sxs-lookup"><span data-stu-id="72729-135">If the value is present, then the current configuration can be found under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\[CurrentConfiguration]`.</span></span> <span data-ttu-id="72729-136">Andernfalls ist es unter `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`.</span><span class="sxs-lookup"><span data-stu-id="72729-136">Otherwise it is under `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\USBFN\Configurations\Default`.</span></span>
2. <span data-ttu-id="72729-137">Fügen Sie unterhalb der aktuellen Konfigurationsschlüssel `\0MTP` auf den Wert der `InterfaceList`.</span><span class="sxs-lookup"><span data-stu-id="72729-137">Under the current configuration key add `\0MTP` to the value of `InterfaceList`.</span></span> <span data-ttu-id="72729-138">Die ***\0*** Teil wird verwendet, mit dem Typ der `InterfaceList` ist `REG_MULTI_SZ` müssen Sie das Trennzeichen zwischen Werten.</span><span class="sxs-lookup"><span data-stu-id="72729-138">The ***\0*** part is used as the type of `InterfaceList` is `REG_MULTI_SZ` and it requires this separator between values.</span></span>
3. <span data-ttu-id="72729-139">Ändern der `MSOSCompatIdDescriptor` Wert einschließen des MTP Deskriptor.</span><span class="sxs-lookup"><span data-stu-id="72729-139">Modify the `MSOSCompatIdDescriptor` value to include the MTP's descriptor.</span></span> <span data-ttu-id="72729-140">Damit erstellen Sie einen gültigen-Deskriptor mit derzeit alle Schnittstellen, unter dem `InterfaceList` Wert, führen Sie die Anweisungen Dokumentation zur Verfügung, am unteren Rand [auf dieser Seite](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span><span class="sxs-lookup"><span data-stu-id="72729-140">In order to create a valid descriptor containing all interfaces currently under the `InterfaceList` value, please follow the instructions documentation available at the bottom of [this page](https://msdn.microsoft.com/windows/hardware/gg463179.aspx).</span></span> <span data-ttu-id="72729-141">*OS_Desc_CompatID.doc* bietet eine Erklärung des Deskriptors des Formats und der ein Beispiel für mehrere Schnittstellen im Deskriptor einschließlich.</span><span class="sxs-lookup"><span data-stu-id="72729-141">*OS_Desc_CompatID.doc* gives an explanation of the descriptor's format and an example of including multiple interfaces in the descriptor.</span></span> <span data-ttu-id="72729-142">MTP kompatiblen und nicht kompatible IDs sind auch auf derselben Seite verfügbar und werden in eines der Beispiele verwendet.</span><span class="sxs-lookup"><span data-stu-id="72729-142">MTP's compatible and sub-compatible IDs are also available on the same page and are used in one of the examples.</span></span>

## <a name="how-to-include-mtp-in-your-custom-ffu"></a><span data-ttu-id="72729-143">Zum Einschließen von MTP in Ihre benutzerdefinierte FFU</span><span class="sxs-lookup"><span data-stu-id="72729-143">How to include MTP in Your Custom FFU</span></span>

1. <span data-ttu-id="72729-144">Hinzufügen **IOT_MTP** Funktions-ID an den OEM-Eingabedatei.</span><span class="sxs-lookup"><span data-stu-id="72729-144">Add **IOT_MTP** feature ID to the OEM Input file.</span></span> <span data-ttu-id="72729-145">Dies entspricht der folgenden Schritte von der "[**Bereitstellen des Geräts mit der erforderlichen Pakete**](#provisioning-the-device-with-required-packages)" im Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="72729-145">This is an equivalent of following the steps from the "[**Provisioning the device with required packages**](#provisioning-the-device-with-required-packages)" section.</span></span>
2. <span data-ttu-id="72729-146">Stellen Sie sicher, dass Änderungen an der gleichen Registrierung anwenden, wie in der "[**erstellen eine neue USBFN-Konfiguration mit der MTP-Schnittstelle**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)" im Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="72729-146">Make sure to apply the same registry changes as mentioned in the "[**Creating a new USBFN configuration with the MTP interface**](#creating-a-new-usbfn-configuration-with-the-mtp-interface)" section.</span></span> <span data-ttu-id="72729-147">Führen Sie [diese Anweisungen](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) erfahren, wie ein FFU registrierungsänderungen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="72729-147">Follow [these instructions](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) to learn how to apply registry changes to an FFU.</span></span>
3. <span data-ttu-id="72729-148">Erstellen Sie die Image\FFU.</span><span class="sxs-lookup"><span data-stu-id="72729-148">Create the image\FFU.</span></span> <span data-ttu-id="72729-149">Lesen [in diesem Artikel](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="72729-149">Read [this article](https://docs.microsoft.com/windows-hardware/manufacture/iot/create-a-basic-image) for instructions.</span></span>

> [!WARNING]
> <span data-ttu-id="72729-150">Ändern der Standardkonfiguration werden nicht durch die Anpassung der FFU unternommen.</span><span class="sxs-lookup"><span data-stu-id="72729-150">Modifying the default configuration should not be attempted through FFU customization.</span></span> <span data-ttu-id="72729-151">Systemdefinierte Einträge können von einem Systemupdate aktualisiert oder geändert werden, und ggf. vorhandene benutzerdefinierten Einstellungen gehen verloren.</span><span class="sxs-lookup"><span data-stu-id="72729-151">System-defined entries may be refreshed/changed by a system update and any custom settings will be lost.</span></span>

## <a name="how-to-setup-the-mtp-sd-card-filter"></a><span data-ttu-id="72729-152">Zum Einrichten der Filter der MTP SD-Karte</span><span class="sxs-lookup"><span data-stu-id="72729-152">How to setup the MTP SD card filter</span></span>

<span data-ttu-id="72729-153">Standardmäßig werden MTP den Inhalt einer SD-Karte Auflisten aller Wenn es auf dem Gerät vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="72729-153">By default MTP will enumerate all of the contents of an SD card, if it is present on the device.</span></span> <span data-ttu-id="72729-154">Es ist jedoch möglich, diese Enumeration auf einen bestimmten Unterordner zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="72729-154">It is possible, however, to limit this enumeration to a specific subfolder.</span></span> <span data-ttu-id="72729-155">Zu diesem Zweck müssen Sie einen Registrierungswert hinzufügen `MTPSDFolderFilter` unter dem Registrierungsschlüssel `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`.</span><span class="sxs-lookup"><span data-stu-id="72729-155">In order to do so, you must add a registry value `MTPSDFolderFilter` under the registry key `HKEY_LOCAL_MACHINE\Software\Microsoft\MTP`.</span></span>
<span data-ttu-id="72729-156">Der Wert ist vom Typ `REG_SZ` als kontrollsammlung und enthält einen relativen Pfad zu dem Ordner MTP aufgelistet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="72729-156">The value is of type `REG_SZ` and should contain a relative path to the folder you would like MTP to enumerate.</span></span> <span data-ttu-id="72729-157">Der Ordner wird automatisch erstellt zu erhalten, wenn es nicht bereits vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="72729-157">The folder will get automatically created if it does not already exist.</span></span>

<span data-ttu-id="72729-158">Beispiel-Pfade:</span><span class="sxs-lookup"><span data-stu-id="72729-158">Sample paths:</span></span>
- <span data-ttu-id="72729-159">\FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="72729-159">\FirstLevelDirectory;</span></span>
- <span data-ttu-id="72729-160">FirstLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="72729-160">FirstLevelDirectory;</span></span>
- <span data-ttu-id="72729-161">\FirstLevelDirectory\SecondLevelDirectory;</span><span class="sxs-lookup"><span data-stu-id="72729-161">\FirstLevelDirectory\SecondLevelDirectory;</span></span>
- <span data-ttu-id="72729-162">Never\Before\Created\Directory.</span><span class="sxs-lookup"><span data-stu-id="72729-162">Never\Before\Created\Directory.</span></span>

> [!WARNING]
> <span data-ttu-id="72729-163">Verwenden Sie keinen absoluten Pfad, der mit dem Laufwerksbuchstaben wie `C:\Some\Folder\Path` – Dies kann verhindern, dass die SD-Karte aufgezählt werden.</span><span class="sxs-lookup"><span data-stu-id="72729-163">Do not use an absolute path containing the drive letter like `C:\Some\Folder\Path` - this might prevent the SD card from being enumerated.</span></span>

<span data-ttu-id="72729-164">Finden Sie unter [diesen Link](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) ausführliche Informationen zum Anpassen des Abbilds mit spezifischen Registrierungseinträgen.</span><span class="sxs-lookup"><span data-stu-id="72729-164">See [this link](https://docs.microsoft.com/windows-hardware/manufacture/iot/add-a-registry-setting-to-an-image) for details about customizing your image with specific registry entries.</span></span>
